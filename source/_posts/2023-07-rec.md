---
title: 2023.7 做题记录
date: 2023-07-11 22:09:32
categories:
  - 做题记录
---

乐，7.11 才开始写．

别连自己 NOI 是怎么打的铁都不知道．

<!-- more -->

## 山东省队集训 2022 Day1 T1

设 $f_{u, i, 0 / 1}$ 代表 $u$ 填了 $i$，$u$ 的子树内满足条件且最大值在 / 不在 $u$ 处取到的方案数．

对于 $0$ 的情况，转移显然．对于 $1$ 的情况，枚举在哪棵子树中取到最大值，统计方案．

这个复杂度有点寄，甚至过不了 50 分．加一车前缀和之后可以过．

正解就是这个换下根．嘴巴会了，没写代码．

## 山东省队集训 2022 Day2 T1

怎么连着两场都只有 T1 有分？

积木大赛的结论是区间正差分和．在平衡树上维护 $a_i - a_{i - 1}$ 和 $a_i - a_{i + 1}$ 即可支持区间翻转．撤销操作建操作树即可．注意修改的边界讨论．

可能是我写丑了，这题代码超级 /tuu，赛时还没调出来．ckain 赛时过掉了，拜谢 ckain．

[代码](/files/2023-07-rec/sequence.cpp)．

## [Codeforces 1845E Boxes and Balls](https://codeforces.com/contest/1845/problem/E)

补补补．[题解](/posts/cf1845e-solution)．

## [Codeforces 1845F Swimmers in the Pool](https://codeforces.com/contest/1845/problem/F)

补补补．[题解](/posts/cf1845f-solution)．

## [洛谷 4140 奇数国](https://www.luogu.com.cn/problem/P4140)

发现是计算询问是计算 $\varphi$．设 $n = \prod_{i=1}^{s}p_i^{k_i}$，有 $\varphi(n) = n \times \prod_{i = 1}^s{\dfrac{p_i - 1}{p_i}}$．

于是在线段树上维护区间乘积和区间质因数出现情况，第二个可以状压存．

## [AtCoder arc067_c Grouping](https://atcoder.jp/contests/arc067/tasks/arc067_c)

设 $f_{i, j}$ 表示考虑了人数 $\le i$ 的组，已经使用了 $j$ 个人的方案数．

转移时枚举当前人数分的组数 $k, c \le k \le d$，有转移方程：

$$
f_{i, j} = f_{i - 1, j} + \sum_k \binom{n - (j - ik)}{ik} \times f_{i - 1, j - ik} \times h(i, j)
$$

其中 $h(i, j)$ 代表人数为 $i$ 的组分 $k$ 个的方案数，即

$$
h(i, j) = \frac{1}{j!} \prod_p \binom{ik - ip}{i}
$$

容易预处理．然后就可以 $O(n^2 \log n)$ 地 DP 了．

## [洛谷 4569 [BJWC2011] 禁忌](https://www.luogu.com.cn/problem/P4569)

多串匹配，首先建出 AC 自动机．

设 $f_{i, u}$ 表示前 $i$ 位匹配到 $u$ 节点的概率．有转移：

$$
f_{i + 1, v} = f_{i, u} / |\Sigma|
$$

其中 $v$ 代表匹配后走到的节点．注意匹配不能交，每次匹配后要走到 $0$．

DP 过程中每次匹配时统计答案，然后放矩阵里快速幂．

## [洛谷 6478 [NOI Online #2 提高组] 游戏](https://www.luogu.com.cn/problem/P6478)

首先二项式反演一下，算钦定 $k$ 对非平局的方案．

设 $f_{u, i}$ 表示 $u$ 子树内钦定 $k$ 对点的方案数．子树的方案树上背包转移一下，然后分讨当前点的颜色，计算从自己子树中选一个异色点的方案数．

## [洛谷 5591 小猪佩奇学数学](https://www.luogu.com.cn/problem/P5591)

巨大推式题．[题解](/posts/lg5591-solution)．

## [LOJ 6498 「雅礼集训 2018 Day2」农民](https://loj.ac/p/6498)

发现一个权值为 $x$ 的点能被走到的充要条件为：到根的链上所有作为左儿子的节点，其父亲的权值 $> x$；所有作为右儿子的节点，其父亲的权值 $< x$．

轻重链剖分维护每个点是哪个儿子和作为左 / 右儿子节点的父亲节点的权值的 `minmax`，然后就能转子树了．

## [LOJ 6499 「雅礼集训 2018 Day2」颜色](https://loj.ac/p/6499)

8 MB，强制在线．考虑分块．

bitset 存颜色出现情况，块间建 ST，卡卡空间．没了．

## [LOJ 6503 「雅礼集训 2018 Day4」Magic](https://loj.ac/p/6503)

大家写分治 FFT 都这么鬼畜的吗？[题解](/posts/loj6503-solution)．

## [LOJ 6508 「雅礼集训 2018 Day7」B](https://loj.ac/p/6508)

令 $f(x) = (ax + b) \bmod n$．考虑每个 $T_i$ 能够贡献到的 $p$．

若 $T_i = 1$，有 $f(x) \in [0, c)$，解得 $\overline{x} \in \overline{[-ia, c - ia)}$．

若 $T_i = 0$，有 $f(x) \in [c, n)$，解得 $\overline{x} \in \overline{[c - ia, n - ia)}$．

其中的诡异记号 $\overline{x}$ 表示 $x$ 在模 $n$ 意义下．

搞棵动态开点线段树维护．

## [LOJ 6066 「2017 山东一轮集训 Day3」第二题](https://loj.ac/p/6066)

先二分转化成判定性问题．

子树同构，一眼哈希．但是常用的树哈希方式并不支持限制深度的子树查询．

但是这题中树的儿子是有序的！这启发我们对括号序进行哈希．

对深度为 $k$ 的子树的括号序哈希可以通过枚举深度为 $k + 1$ 的儿子然后去除不需要的部分，剩下拼接起来．

这个复杂度是对的，因为每个点只会是一个点的深度为 $k$ 的儿子，那么枚举量就是 $O(n)$ 的．

## [LOJ 6119 「2017 山东二轮集训 Day7」国王](https://loj.ac/p/6119)

难以发现那个两端都在 / 不在区间内的限制其实是没有用的，至少我没看出来．

考虑将限制放松为只有一个端点在区间内，然后不等式两边会有一个相同的量，可以消掉．

那么我们设 $\mathrm{ct}_i$ 表示 $i$ 开始的 exciting 路径条数，这个可以点分治计算．

答案就是求满足

$$
\sum_{i \in [l, r]} w_i > \sum_{i \not\in [l, r]} w_i
$$

的区间 $[l, r]$ 个数．有单调性，双指针统计一下．