---
title: QBXT 2023.7.28 模拟赛 做题记录
date: 2023-07-28 22:24:55
categories: 做题记录
tag:
  - 动态规划
---

0 + 80 + 60 + 0．

挂分．/oh

<!-- more -->

## A. 网格行走

为啥值域只开 $128$，std 不会写的 $O(nmV)$ 吧．/qd

拆位 DP，计算每一位上异或和为 $1$ 的方案数即可．时间复杂度 $O(nm \log V)$．

## B. 树

枚举根做 DP，$O(n^3)$ 是容易的．

考虑如何优化．对于一条路径，考虑将其贡献在端点的 LCA 处计算，类似树形背包合并即可．

## C. 序列

设 $f_{i, j}$ 表示考虑了低 $i$ 位，需要进 $j$ 位，且序列中元素低 $i$ 位的和等于 $m$ 的低 $i$ 位的方案数，$g_{i, j}$ 表示考虑了低 $i$ 位，需要进 $j$ 位的方案数．转移枚举 $x$ 个元素第 $i + 1$ 位上是 $1$，且 $(j + x) \bmod 2$ 和 $m$ 的第 $i$ 位相同．$g_{i, j}$ 的转移有两种贡献，将低 $i$ 位和第 $i + 1$ 位对异或和的贡献分开考虑．那么我们有如下转移：

$$
\begin{aligned}
  f_{i + 1, (j + x) / 2} &\leftarrow \binom{n}{x} f_{i, j} \\
  g_{i + 1, (j + x) / 2} &\leftarrow \binom{n}{x} g_{i, j} + [j \bmod 2 = 1] \binom{n}{x} 2^i f_{i, j}
\end{aligned}
$$

## D. 酒馆

E5-2682 v4．/qd

首先观察到，在最优的方案中存在一个酒馆，使得能到这个酒馆的所有人都到了这个酒馆．

那么我们可以设 $f_{l, r}$ 表示只考虑只能到达 $[l, r]$ 内的人，最大的收益是多少．设 $w_{k, t}$ 表示有 $t$ 个人到了第 $k$ 家店的最大收益．枚举最大值取到的位置 $k$，我们有转移

$$
f_{l, r} \leftarrow f_{l, k - 1} + f_{k + 1, r} + w_{k, t}
$$

其中 $t$ 可以通过一个类似二维前缀和的东西计算．

考虑如何求出 $w_{k, i}$，有转移 $w_{k, i} \leftarrow j \times i - c_{k, j}$，这是标准的斜率优化，直接做就行了．

感谢 QBXT 的 shaber 评测机，带 $\log$ 过不了．
