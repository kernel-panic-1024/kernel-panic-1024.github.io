---
title: 2023.1 做题记录
date: 2023-01-22 22:59:52
description: WIP
categories:
- 做题记录
---
## [P5268 [SNOI2017] 一个简单的询问](https://www.luogu.com.cn/problem/P5268)
发现可以拆询问，答案即为：
$$
\displaystyle\sum_{x}q(r_1,r_2)-q(l_1-1,r_2)-q(r_1,l_2-1)+q(l_1-1,l_2-1)
$$

其中 $q(a,b)=\operatorname{get}(1,a,x)\operatorname{get}(1,b,x)$．

$q(a,b)$ 使用莫队维护，移动端点 $l,r$ 的过程中维护 $c_x,d_x$，分别表示 $[1,l],[1,r]$ 区间内 $x$ 的出现次数．容易维护答案．

## [P3224 [HNOI2012] 永无乡](https://www.luogu.com.cn/problem/P3224)
用并查集维护连通性，权值线段树维护联通块内的排名．

注意合并并查集和合并权值线段树的方向要一致．

## [P8110 [Cnoi2021] 矩阵](https://www.luogu.com.cn/problem/P8110)
趣味数学题．

进行一个式子的推，我们有：
$$
\begin{aligned}
\left(A^2\right)_{i,j}
&= \sum_{k=1}^n A_{i,k}A_{k,j} \\
&= \sum_{k=1}^n a_ib_ka_kb_j \\
&= a_ib_j\sum_{k=1}^n a_kb_k \\
&= A_{i,j}\sum_{k=1}^n A_{k,k} \\
\end{aligned}
$$

归纳可得：
$$
\left(A^x\right)_{i,j}=A_{i,j}\left(\sum_{k=1}^n A_{k,k}\right)^{x-1}
$$

所以有：
$$
\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^n\left(A^x\right)_{i,j}
&= \sum_{i=1}^n\sum_{j=1}^nA_{i,j}\left(\sum_{k=1}^n A_{k,k}\right)^{x-1} \\
&= \left(\sum_{k=1}^n A_{k,k}\right)^{x-1}\sum_{i=1}^n\sum_{j=1}^n A_{i,j} \\
&= \left(\sum_{k=1}^n a_kb_k\right)^{x-1}\sum_{i=1}^n\sum_{j=1}^n a_ib_j \\
&= \left(\sum_{k=1}^n a_kb_k\right)^{x-1}\left(\sum_{i=1}^n a_i\right)\left(\sum_{i=1}^n b_i\right) \\
\end{aligned}
$$

分别计算 $\left(\displaystyle\sum_{k=1}^n a_kb_k\right)^{k-1}$，$\displaystyle\sum_{i=1}^n a_i$ 和 $\displaystyle\sum_{i=1}^n b_i$ 即可．
